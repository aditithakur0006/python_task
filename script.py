import os
import sys
import json

service_file = "service-list.txt"
progress_file = "progress.txt"

if not os.path.exists(service_file):
    my_list = [
{
'service_name': 'mekong-service-sportcast-relay-EcsService-ylGBXDJthWvx',
'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-sportcast-relay:2',
'image_tag': ['v3.0.0-ee1980mekongenv-41e7a5cd']
},{'service_name': 'mekong-service-prismic-EcsService-nysFyVTJojfC', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-prismic:2', 'image_tag': ['buildkite-99-master-7afe247e']}, {'service_name': 'mekong-service-announcement-EcsService-pFdQT7Rva43l', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-announcement:4', 'image_tag': ['v2.0.1-mekongconfig-81d0f377']}, {'service_name': 'mekong-service-invenue-aml-EcsService-FU7e3g0J6Fln', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-invenue-aml:2', 'image_tag': ['270ffb16']}, {'service_name': 'mekong-mesh-nlb-virtual-gateway-EcsService-ncuk5cYnKKGW', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-mesh-nlb-virtual-gateway:3', 'image_tag': ['1.4.1', 'v0.36.0']}, {'service_name': 'mekong-service-amplified-odds-EcsService-ypsBvqtoTIkl', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-amplified-odds:2', 'image_tag': ['v3.0.0-mekongconfig-cd8f3f76']}, {'service_name': 'mekong-api-service-invenue-EcsService-947vZYBTQ8X6', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-invenue:14', 'image_tag': ['75da44bd']}, {'service_name': 'mekong-service-bff-homepage-EcsService-NECV0b6jt3KU', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-bff-homepage:2', 'image_tag': ['v1.5.0-mekongconfig-c44f05e0']}, {'service_name': 'mekong-service-venue-locator-EcsService-fBQWbbRWlwGk', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-venue-locator:2', 'image_tag': ['buildkite-148-mekongconfig-b6c4881d']}, {'service_name': 'mekong-api-service-historical-results-EcsService-0u9E5ggCCOID', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-historical-results:4', 'image_tag': ['v2.0.0-addedmekongenv-5432e205']}, {'service_name': 'mekong-service-mobile-tracker-v2-EcsService-pXv9StDXDoo1', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-mobile-tracker:5', 'image_tag': ['v2.0.0-mekongconfig-25e1a0dd']}, {'service_name': 'mekong-service-email-EcsService-5MxYfZU2VxVD', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-email:4', 'image_tag': ['v2.1.3-ee1538-1ebf16c7']}, {'service_name': 'mekong-service-asymkey-EcsService-NG5j5piTE4b8', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-asymkey:3', 'image_tag': ['v1.0.0-addcongi-a329dc6e']}, {'service_name': 'mekong-service-content-hub-EcsService-SKdStBXRA1de', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-content-hub:4', 'image_tag': ['v3.0.20-sct1655tabmekongconfig-34f75dbd']}, {'service_name': 'mekong-service-bff-social-EcsService-73yee3dg0j3o', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-bff-social:9', 'image_tag': ['v1.4.2-master-68dee8fe']}, {'service_name': 'mekong-service-stats-EcsService-FuyQPcV4s06O', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-stats:21', 'image_tag': ['v4.4.0-mekongconf-ecfa5111']}, {'service_name': 'mekong-api-service-config-EcsService-GTchzZj8Qc9k', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-config:8', 'image_tag': ['1.0.0-epwm447-f1e2b297']}, {'service_name': 'mekong-service-social-orchestrator-EcsService-6de2LZhHf8Ef', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-social-orchestrator:8', 'image_tag': ['v1.4.3-master-e89aab1d']}, {'service_name': 'mekong-api-service-info-datasource-EcsService-mPrdzbGOJFI4', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-info-datasource:4', 'image_tag': ['v1.0.0-master-4f84f5f9']}, {'service_name': 'mekong-service-measurement-EcsService-e96ms1eOUyMz', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-measurement:2', 'image_tag': ['v2.0.0-mekongconfig-dd5a00c5']}, {'service_name': 'mekong-service-multi-builder-EcsService-vqYlYl0rSkPG', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-multi-builder:5', 'image_tag': ['v3.3.0-mekongconfig-eb634680']}, {'service_name': 'mekong-service-predictive-EcsService-e8djwZ6Gmcgb', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-predictive:3', 'image_tag': ['v1.0-master-51b9abf5']}, {'service_name': 'mekong-api-service-account-EcsService-0cEGsMLCNDTB', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-account:285', 'image_tag': ['v7.0.0-master-3043bee1']}, {'service_name': 'mekong-betslip-result-api', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-betslip-result-api:1', 'image_tag': ['0.0.13', 'v0.36.0', '1.4.3']}, {'service_name': 'mekong-service-promotion-gateway-EcsService-87kZVqqEGIV7', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-promotion-gateway:19', 'image_tag': ['v1.2.0-master-c0613f6a']}, {'service_name': 'mekong-service-push-socketio-v2-EcsService-ssRX5tmVWnbr', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-push-socketio:14', 'image_tag': ['v1.7.1']}, {'service_name': 'mekong-api-service-betting-EcsService-rkzCEUTmbh5g', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-betting:33', 'image_tag': ['v4.5.3-bettingmekongconfig-5c26150c']}, {'service_name': 'mekong-service-identity-relay-EcsService-KwDsYnQMTMyV', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-identity-relay:25', 'image_tag': ['1.1.6']}, {'service_name': 'mekong-service-push-socketio-v2-EcsService-NJG3WITRGgMh', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-push-socketio:13', 'image_tag': ['v1.7.1']}, {'service_name': 'mekong-service-discovery-EcsService-5xlomD391Pw4', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-discovery:11', 'image_tag': ['v1.0.9-snykfixfad0cdf5790e124f69cf37306d72fcff-50c4a93f']}, {'service_name': 'mekong-service-lookup-EcsService-tzWD50Iztx8n', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-lookup:3', 'image_tag': ['v2.0.3-epwm527mekongenv-9ff277c9']}, {'service_name': 'mekong-tote-guarantee-tool-EcsService-yEJNFXhlulez', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-tote-guarantee-tool:1', 'image_tag': ['v2.0.0-mekongconfig-cd40e9c6']}, {'service_name': 'mekong-service-partner-entitlements-EcsService-royAHeST97zS', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-partner-entitlements:2', 'image_tag': ['notag-master-7cbe1f03']}, {'service_name': 'mekong-service-popular-bets-worker-EcsService-J2e7apt6nvmK', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-popular-bets-worker:3', 'image_tag': ['v2.0.1']}, {'service_name': 'mekong-api-service-identity-v2-EcsService-pYK3wAY8bJfg', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-identity:9', 'image_tag': ['v2.3.1-wmeng5242mekongidentity-561f3b04']}, {'service_name': 'mekong-service-bet-share-EcsService-ro5Lh9tuP7WW', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-bet-share:6', 'image_tag': ['v1.1.2-master-369ba623']}, {'service_name': 'mekong-service-sms-gateway-EcsService-nUHz0kAT1lJt', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-sms-gateway:21', 'image_tag': ['v1.0.0-v100-d188f553']}, {'service_name': 'mekong-service-geo-transactions-v2-EcsService-WRSyPNOamNvB', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-geo-transactions:8', 'image_tag': ['buildkite-851-venuesr9-b2fd044b']}, {'service_name': 'mekong-raceday-central-comet-publisher', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-raceday-central-comet-publisher:2', 'image_tag': ['1.1-beta.24081.0.17385-6dc31c33', 'v0.36.0', '1.4.3']}, {'service_name': 'mekong-service-info-premium-EcsService-SwbW8WCX08y0', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-info-premium:5', 'image_tag': ['v1.1.0-master-65421ba1']}, {'service_name': 'mekong-service-statement-enrichment-EcsService-A2Zy2732rzcJ', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-statement-enrichment:8', 'image_tag': ['v1.3.5-ee3119-71e0e300']}, {'service_name': 'mekong-api-service-vision-live-data-EcsService-cXG1XR6uTfv2', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-vision-live-data:11', 'image_tag': ['buildkite-981-mekong-9d245dd4']}, {'service_name': 'mekong-api-service-vision-correlator-EcsService-JaTAwXZyG6Iu', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-vision-correlator:6', 'image_tag': ['buildkite-1188-mekong-9d245dd4']}, {'service_name': 'mekong-service-content-EcsService-94U69l6xhUdq', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-content:6', 'image_tag': ['v1.0.0-mekongconfig-26f83015']}, {'service_name': 'mekong-service-metadata-EcsService-GIjcRpDyX1j4', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-metadata:8', 'image_tag': ['v1.0.1-mekongconfig-902faf94']}, {'service_name': 'mekong-service-trending-bets-EcsService-83kgdYrF6yvx', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-trending-bets:3', 'image_tag': ['v1.6.0']}, {'service_name': 'mekong-service-kv-store-EcsService-oGWN1BreSb3V', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-kv-store:5', 'image_tag': ['notag-fixsecretsimport-a78c1013']}, {'service_name': 'mekong-api-service-recommendation-EcsService-Qtx7FgbTFySv', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-recommendation:8', 'image_tag': ['v1.0.6-epwm420-274198d0']}, {'service_name': 'mekong-api-service-vision-live-matches-EcsService-OSUcHuiw7NPu', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-vision-live-matches:5', 'image_tag': ['buildkite-1321-mekong-9d245dd4']}, {'service_name': 'mekong-service-cms-EcsService-0UF8zOaen9Ao', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-cms:3', 'image_tag': ['v1.0.0-mekongconfig-1cfd6eca']}, {'service_name': 'mekong-service-reuse-selections-EcsService-z95nRVvcddZh', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-reuse-selections:2', 'image_tag': ['v1.0.0']}, {'service_name': 'mekong-service-bff-racing-EcsService-KvB4RoDEhBIa', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-bff-racing:4', 'image_tag': ['v1.7.1']}, {'service_name': 'mekong-social-teams-manager-EcsService-gpi8ofDh6IMT', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-social-teams-manager:1', 'image_tag': ['v1.1.0-snykfix72179662bcd85d5fa28d9a3f1eb551c8-4fb8e1e8']}, {'service_name': 'mekong-service-mapping-EcsService-C2elQ30EQkmm', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-mapping:7', 'image_tag': ['v3.9.1-epwm451-6e5eb05a']}, {'service_name': 'mekong-service-pricing-EcsService-ittL0bjxYZNS', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-pricing:4', 'image_tag': ['v4.5.0-ee3119-92a94965']}, {'service_name': 'mekong-service-preference', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-preference:10', 'image_tag': ['v1.0.0-master-74b67545', '1.4.3']}, {'service_name': 'mekong-service-idv-EcsService-Aw7epPZtDRxT', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-idv:34', 'image_tag': ['v3.4.1-nodeupgrade-af04268f']}, {'service_name': 'mekong-service-blackbook-v2-EcsService-G5mqSkAZ2xZN', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-blackbook-v2:10', 'image_tag': ['v3.1.0-sewm1027-2f855bfe']}, {'service_name': 'mekong-digital-push-adapter-EcsService-dL0HpVcPImHu', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-digital-push-adapter:3', 'image_tag': ['b99fc17']}, {'service_name': 'mekong-service-bff-sports-EcsService-g3PJYIdDWjDM', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-bff-sports:8', 'image_tag': ['v2.17.0-sewm1852marketmsg-30505db4']}, {'service_name': 'mekong-api-service-promotions-EcsService-mhmc5EdDYUsO', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-promotions:37', 'image_tag': ['v2.5.0-master-424496de']}, {'service_name': 'mekong-service-bff-personalisation', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-bff-personalisation-task_definition:9', 'image_tag': ['1.6.0', 'notag-master-47c158eb']}, {'service_name': 'mekong-api-service-application-EcsService-P8cdSKEti6HL', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-api-service-application:6', 'image_tag': ['v1.0.0-mekongconfig-ffa81c72']}, {'service_name': 'mekong-service-preference-worker-EcsService-w3BG3yOKvFbR', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-preference-worker:9', 'image_tag': ['v1.1.1-master-ba9d6ead']}, {'service_name': 'mekong-service-digital-commissions-EcsService-PMVA4RwrETr5', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-digital-commissions:2', 'image_tag': ['buildkite-93-venuesr2-4ab3991b']}, {'service_name': 'mekong-service-info-wift-EcsService-sQjvKo8DnTgi', 'ecs_task_def': 'arn:aws:ecs:ap-southeast-2:012276878427:task-definition/mekong-service-info-wift:18', 'image_tag': ['v4.15.0']}
]
    with open(service_file, "w") as f:
            json.dump(my_list, f, indent=4)

try:
    with open(service_file, "r") as f:
        my_list = json.load(f)
except json.JSONDecodeError:
    print("Error: Unable to read service file. Ensure it contains valid JSON.")
    sys.exit(1)

if os.path.exists(progress_file):
    try:
        with open(progress_file, "r") as f:
            last_index = int(f.read().strip())
    except ValueError:
        print("Error: Progress file contains invalid data. Resetting progress.")
        last_index = 0
else:
    last_index = 0  

for i in range(last_index, len(my_list)):
    service = my_list[i]
    print(f"Approval needed for '{service['service_name']}' in Jenkins.")

    with open(progress_file, "w") as f:
        f.write(str(i + 1))

    sys.exit(100)

if os.path.exists(progress_file):
    os.remove(progress_file)

print("Python script completed.")
